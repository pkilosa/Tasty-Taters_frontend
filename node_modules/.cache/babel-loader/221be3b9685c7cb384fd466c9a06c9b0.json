{"ast":null,"code":"import API from \"../../API\";\nimport { addCartAction, increaseCartAction, decreaseCartAction, fetchCartAction } from \"./actions\";\nconst api = new API();\nconst CARTS_KEY = \"CARTS_KEY\";\nexport const fetchFromLocalStorage = () => {\n  return async dispatch => {\n    let cartsJSON = localStorage.getItem(CARTS_KEY);\n    let carts = {};\n\n    if (cartsJSON) {\n      carts = JSON.parse(cartsJSON);\n    }\n\n    const subtotal = calculateSubtotal(carts);\n    dispatch(fetchCartAction(carts, subtotal));\n  };\n};\nexport const addCart = item => {\n  return async (dispatch, getState) => {\n    let prevCarts = getState().carts.list;\n    prevCarts[item.id] = {\n      item: item,\n      selected_count: 1\n    };\n    const subtotal = calculateSubtotal(prevCarts);\n    setToLocalStorage(prevCarts);\n    dispatch(addCartAction(prevCarts, subtotal));\n  };\n};\nexport const increaseCart = item => {\n  return async (dispatch, getState) => {\n    let prevCarts = getState().carts.list;\n    let nextSelectedCount = prevCarts[item.id].selected_count + 1;\n    prevCarts[item.id] = {\n      \"item\": item,\n      \"selected_count\": nextSelectedCount\n    };\n    const subtotal = calculateSubtotal(prevCarts);\n    setToLocalStorage(prevCarts);\n    dispatch(increaseCartAction(prevCarts, subtotal));\n  };\n};\nexport const decreaseCart = item => {\n  return async (dispatch, getState) => {\n    let prevCarts = getState().carts.list;\n    let nextSelectedCount = prevCarts[item.id].selected_count - 1;\n\n    if (nextSelectedCount > 0) {\n      prevCarts[item.id] = {\n        \"item\": item,\n        \"selected_count\": nextSelectedCount\n      };\n    } else {\n      delete prevCarts[item.id];\n    }\n\n    const subtotal = calculateSubtotal(prevCarts);\n    setToLocalStorage(prevCarts);\n    dispatch(decreaseCartAction(prevCarts, subtotal));\n  };\n};\n\nconst setToLocalStorage = carts => {\n  localStorage.setItem(CARTS_KEY, JSON.stringify(carts));\n};\n\nconst calculateSubtotal = carts => {\n  let subtotal = 0;\n  console.log(carts);\n\n  for (let key in carts) {\n    if (carts[key]) {\n      subtotal += Number(carts[key].item.price) * carts[key].selected_count;\n    }\n  }\n\n  console.log(subtotal);\n  return subtotal;\n  subtotal = '';\n};","map":{"version":3,"names":["API","addCartAction","increaseCartAction","decreaseCartAction","fetchCartAction","api","CARTS_KEY","fetchFromLocalStorage","dispatch","cartsJSON","localStorage","getItem","carts","JSON","parse","subtotal","calculateSubtotal","addCart","item","getState","prevCarts","list","id","selected_count","setToLocalStorage","increaseCart","nextSelectedCount","decreaseCart","setItem","stringify","console","log","key","Number","price"],"sources":["/Users/admin/Downloads/techis-wd-forum-django-react-main/frontend/src/reducks/carts/operations.js"],"sourcesContent":["import API from \"../../API\"\nimport {addCartAction, increaseCartAction, decreaseCartAction, fetchCartAction} from \"./actions\";\n\nconst api = new API();\nconst CARTS_KEY = \"CARTS_KEY\";\n\nexport const fetchFromLocalStorage = () => {\n    return async (dispatch) => {\n        let cartsJSON = localStorage.getItem(CARTS_KEY);\n        let carts = {};\n        if (cartsJSON) {\n            carts = JSON.parse(cartsJSON);\n        }\n        const subtotal = calculateSubtotal(carts);\n        dispatch(fetchCartAction(carts, subtotal));\n    }\n}\n\nexport const addCart = (item) => {\n    return async (dispatch, getState) => {\n        let prevCarts = getState().carts.list\n        prevCarts[item.id] = {item: item, selected_count: 1};\n        const subtotal = calculateSubtotal(prevCarts);\n        setToLocalStorage(prevCarts);\n        dispatch(addCartAction(prevCarts, subtotal));\n   }\n}\nexport const increaseCart = (item) => {\n    return async (dispatch, getState) => {\n        let prevCarts = getState().carts.list\n        let nextSelectedCount = prevCarts[item.id].selected_count + 1;\n        prevCarts[item.id] = {\"item\": item, \"selected_count\": nextSelectedCount};\n        const subtotal = calculateSubtotal(prevCarts);\n        setToLocalStorage(prevCarts);\n        dispatch(increaseCartAction(prevCarts, subtotal))\n   }\n}\n\nexport const decreaseCart = (item) => {\n    return async (dispatch, getState) => {\n        let prevCarts = getState().carts.list\n        let nextSelectedCount = prevCarts[item.id].selected_count - 1;\n        if (nextSelectedCount > 0) {\n            prevCarts[item.id] = {\"item\": item, \"selected_count\": nextSelectedCount};\n        } else {\n            delete prevCarts[item.id];\n        }\n        const subtotal = calculateSubtotal(prevCarts);\n        setToLocalStorage(prevCarts);\n        dispatch(decreaseCartAction(prevCarts, subtotal))\n   }\n}\n\nconst setToLocalStorage = (carts) => {\n    localStorage.setItem(CARTS_KEY, JSON.stringify(carts));\n}\n\nconst calculateSubtotal = (carts) => {\n    let subtotal=0;\n    console.log(carts);\n        for (let key in carts) {\n            if(carts[key]){\n                subtotal += (Number(carts[key].item.price) * carts[key].selected_count);\n            }\n        \n    }\n    console.log(subtotal);\n   return subtotal;\n    subtotal = ''\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}